(()=>{const e=document.querySelector(".city-input"),t=document.querySelector(".search-btn"),n=(document.querySelector(".location-btn"),document.querySelector(".current-weather")),i=document.querySelector(".weather-cards"),r=(document.querySelector(".error_text"),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][(new Date).getDay()]),a="c93fd1817f3fbe42aeac0a63076603b9",o=(t,o,s)=>{fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${o}&lon=${s}&appid=${a}`).then((e=>e.json())).then((a=>{const o=a.city.sunrise,s=a.city.sunset,c=[],h=a.list.filter((e=>{const t=new Date(e.dt_txt).getDate();if(!c.includes(t))return c.push(t)}));e.value="",n.innerHTML="",i.innerHTML="",h.forEach(((e,a)=>{const c=((e,t,n,i,a)=>{if(0===a){const a=new Date(1e3*t).toUTCString().slice(-30,-7),o=new Date(1e3*n).toUTCString().slice(-30,-7);return`<div class="details">\n                    <h2>${r} <span>|</span> ${i.dt_txt.split(" ")[0]}</h2>\n                    <h2>${e}</h2>\n                    <h6 id="main-temp">${(i.main.temp-273.15).toFixed(0)}°C</h6>\n                    <div class="min_max">\n                    <h6>L : ${(i.main.temp_min-273.15).toFixed(0)}°C</h6>\n                    <span>|</span>\n                    <h6>H : ${(i.main.temp_max-273.15).toFixed(0)}°C</h6>\n                    </div>\n                    <h6>Feels Like: ${(i.main.feels_like-273.15).toFixed(2)}°C</h6>\n                    <h6>Wind: ${i.wind.speed} M/S</h6>\n                    <h6>Visibility: ${i.visibility/100} KM</h6>\n                    <h6 class="sunset_sunrise">Sunrise: ${o} </h6>\n                    <h6 class="sunset_sunrise">Sunset: ${a} </h6>\n                </div>\n                <div class="icon">\n                    <img src="https://openweathermap.org/img/wn/${i.weather[0].icon}@4x.png" alt="weather-icon">\n                    <h6>${i.weather[0].description}</h6>\n                </div>`}return`<li class="card">\n                    <h3>${i.dt_txt.split(" ")[0]}</h3>\n                    <img src="https://openweathermap.org/img/wn/${i.weather[0].icon}@4x.png" alt="weather-icon">\n                    <h6>${i.weather[0].description.toUpperCase()}</h6>\n                    <h6>Temp: ${(i.main.temp-273.15).toFixed(2)}°C</h6>\n                    <h6>Wind: ${i.wind.speed} M/S</h6>\n                    <h6>Humidity: ${i.main.humidity}%</h6>\n                </li>`})(t,o,s,e,a);0===a?n.insertAdjacentHTML("beforeend",c):i.insertAdjacentHTML("beforeend",c)}))})).catch((()=>{alert("An error occurred while fetching the weather forecast!")}))},s=()=>{const t=e.value.trim();""!==t&&fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${t}&limit=1&appid=${a}`).then((e=>e.json())).then((e=>{if(!e.length)return c();const{lat:t,lon:n,name:i}=e[0];o(i,t,n)})).catch((()=>{alert("An error occurred while fetching the coordinates!")}))};function c(){alert(`No coordinates found for ${cityName}`)}navigator.geolocation.getCurrentPosition((e=>{const{latitude:t,longitude:n}=e.coords;fetch(`https://api.openweathermap.org/geo/1.0/reverse?lat=${t}&lon=${n}&limit=1&appid=${a}`).then((e=>e.json())).then((e=>{const{name:i}=e[0];o(i,t,n)})).catch((()=>{alert("An error occurred while fetching the city name!")}))}),(e=>{e.code===e.PERMISSION_DENIED?alert("Geolocation request denied. Please reset location permission to grant access again"):alert("Geolocation request error. Please reset location permission.")})),t.addEventListener("click",s),e.addEventListener("keyup",(e=>"Enter"===e.key&&s()))})();